<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Agent Service</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Movie Agent Service</h1>
            <p class="subtitle">Intelligent movie recommendations and analysis</p>
            <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px; padding: 10px; margin: 10px 0; text-align: center; font-size: 0.9em; color: #856404;">
                <strong>Demo Version:</strong> This project uses a small movie dataset (CSV) for demonstration purposes only. 
                Results may be limited compared to a full production database.
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px; gap: 10px;">
                <a href="https://github.com/abzanganeh" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #24292e; color: white; text-decoration: none; border-radius: 6px; font-size: 0.9em; font-weight: 500; transition: background 0.2s;">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="vertical-align: middle;">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    Follow @abzanganeh
                </a>
                <button onclick="resetConfig()" style="padding: 8px 16px; background: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9em;">
                    Reset Config
                </button>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('chat')">Chat</button>
            <button class="tab-button" onclick="switchTab('image')">Image Analysis</button>
            <button class="tab-button tab-button-about" onclick="switchTab('about')">About</button>
        </div>

        <!-- Chat Tab -->
        <div id="chat-tab" class="tab-content active">
            <div class="chat-container">
                <div id="chat-messages" class="chat-messages"></div>
                <div class="chat-input-container">
                    <input 
                        type="text" 
                        id="chat-input" 
                        placeholder="Ask me about movies, quizzes, comparisons, or statistics..."
                        onkeypress="handleChatKeyPress(event)"
                    >
                    <button onclick="sendChatMessage()">Send</button>
                </div>
            </div>
        </div>

        <!-- Image Analysis Tab -->
        <div id="image-tab" class="tab-content">
            <div class="image-container">
                <div class="upload-area" id="upload-area">
                    <input 
                        type="file" 
                        id="image-input" 
                        accept="image/*" 
                        onchange="handleImageSelect(event)"
                        style="display: none;"
                    >
                    <div class="upload-placeholder">
                        <p>Click to upload or drag and drop</p>
                        <p class="upload-hint">Supports: JPG, PNG, JPEG</p>
                        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;">
                            <h3 style="margin-top: 0; color: #667eea;">What to Upload</h3>
                            <p style="margin: 10px 0;"><strong>Upload movie posters</strong> to identify the movie, analyze its mood, and get genre information.</p>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Best results with clear, high-quality movie poster images</li>
                                <li>The system will identify the movie title, analyze visual elements, and infer genres</li>
                                <li>After analysis, you can ask questions about the movie in the Chat tab</li>
                            </ul>
                            <p style="margin: 10px 0 0 0; font-size: 0.9em; color: #666;">The analysis uses computer vision to extract visual features and match them with the movie database.</p>
                        </div>
                    </div>
                </div>
                <div id="image-preview" class="image-preview" style="display: none;">
                    <img id="preview-img" src="" alt="Preview">
                    <div class="image-actions">
                        <button onclick="analyzeImage()" class="analyze-button">Analyze Poster</button>
                        <button onclick="resetImagePreview()" class="clear-button">Clear & Upload New</button>
                    </div>
                </div>
                <div id="image-results" class="image-results"></div>
            </div>
        </div>

        <!-- About Tab -->
        <div id="about-tab" class="tab-content">
            <div style="max-width: 900px; margin: 0 auto; padding: 20px; line-height: 1.6; overflow-y: auto; max-height: calc(100vh - 200px);">
                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 0;">Project Overview</h2>
                    <p>This is not just a "prompt + LLM" demo. It is a well-structured agent-based system designed with production-minded principles.</p>
                    
                    <p>
                        <strong>ðŸ”¹ Movie Agent Service (Backend / Agent Layer):</strong><br>
                        <a href="https://github.com/abzanganeh/movie-agent-service" target="_blank" style="color: #3498db; text-decoration: none;">https://github.com/abzanganeh/movie-agent-service</a>
                    </p>
                    
                    <p>
                        <strong>ðŸ”¹ Movie Agent Demo (Flask App / UI Layer):</strong><br>
                        <a href="https://github.com/abzanganeh/movie-agent-demo" target="_blank" style="color: #3498db; text-decoration: none;">https://github.com/abzanganeh/movie-agent-demo</a>
                    </p>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">Architecture Highlights</h2>
                    
                    <h3 style="color: #34495e; margin-top: 25px;">Our Architecture Flow</h3>
                    <div style="background: #f8f9fa; border-left: 4px solid #3498db; padding: 15px; margin: 20px 0; font-family: 'Courier New', monospace; font-size: 0.9em;">
User<br>
 â†“<br>
Service (rules + state management)<br>
 â†“<br>
Agent (LLM reasoning with tool selection)<br>
 â†“<br>
Tools (execution)<br>
 â†“<br>
Service (state update + validation)<br>
 â†“<br>
Response
                    </div>
                    <p>Instead of the simpler but more fragile: <code>User â†’ LLM â†’ Tool â†’ Response</code></p>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">Why Tool-Calling Agent Instead of ReAct?</h2>
                    
                    <p>We chose <strong>tool-calling agent architecture</strong> over ReAct for production-grade reliability and maintainability. This is an intentional design choice, not a limitation.</p>

                    <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 15px; margin: 20px 0;">
                        <h3 style="margin-top: 0;">Key Advantages:</h3>
                        <ul style="margin-left: 20px;">
                            <li><strong>Service controls rules and state:</strong> Business logic lives in code, not prompts</li>
                            <li><strong>Predictable behavior:</strong> Clear tool mapping and explicit constraints</li>
                            <li><strong>Clean final answers:</strong> No reasoning leaks to users</li>
                            <li><strong>Easier debugging:</strong> State transitions and validation are explicit</li>
                            <li><strong>Better maintainability:</strong> Rules can evolve in code, not embedded in prompts</li>
                        </ul>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">Intended Limitations & Design Trade-offs</h2>
                    
                    <div style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; margin: 20px 0;">
                        <h3 style="margin-top: 0;">Known Limitations (By Design):</h3>
                        <ul style="margin-left: 20px;">
                            <li><strong>Restricted question types:</strong> Handles specific, well-defined query types rather than open-ended reasoning</li>
                            <li><strong>Limited dataset:</strong> Demo uses a small CSV dataset</li>
                            <li><strong>No open-ended reasoning:</strong> We don't support arbitrary multi-step reasoning chains (intentional)</li>
                            <li><strong>Fixed tool set:</strong> Only predefined tools are available</li>
                        </ul>
                    </div>

                    <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 15px; margin: 20px 0;">
                        <h3 style="margin-top: 0;">Why These Limitations Are Acceptable:</h3>
                        <p><strong>This structure is more robust despite these limitations</strong> because:</p>
                        <ul style="margin-left: 20px;">
                            <li><strong>Predictability:</strong> We know exactly what the system can and cannot do</li>
                            <li><strong>Debugging:</strong> Issues can be traced through code paths</li>
                            <li><strong>Testing:</strong> Each component can be tested in isolation</li>
                            <li><strong>Evolution:</strong> New features are added through structured code changes</li>
                            <li><strong>Production readiness:</strong> The system behaves consistently</li>
                        </ul>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">OOP Principles Applied</h2>
                    <ul style="margin-left: 20px;">
                        <li><strong>Single Responsibility:</strong> Each class has one clear purpose</li>
                        <li><strong>Separation of Decision & Action:</strong> Classes either decide or act, but not both (unless Agents)</li>
                        <li><strong>Dependency Inversion:</strong> Dependencies are injected, not hardcoded</li>
                        <li><strong>Encapsulation:</strong> Internal logic and state are properly encapsulated</li>
                        <li><strong>Factory Pattern:</strong> Tools and components are created via factories</li>
                        <li><strong>Strategy Pattern:</strong> Different question generators for quiz types</li>
                    </ul>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">Future Extensibility</h2>
                    <p>The architecture is designed to grow. In production, the service can easily be extended with:</p>
                    <ul style="margin-left: 20px;">
                        <li>Additional tools (external APIs, vector search, RAG, analytics)</li>
                        <li>More agents or collaborative workflows</li>
                        <li>Persistent memory or user profiles</li>
                        <li>Observability and guardrails</li>
                    </ul>
                    <p><strong>The key point:</strong> The architecture is designed to grow, not to be rewritten.</p>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 30px;">Author</h2>
                    <p>
                        <strong>Alireza Barzin Zanganeh</strong><br>
                        Website: <a href="https://www.zanganehai.com/about" target="_blank" style="color: #3498db; text-decoration: none;">zanganehai.com</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

